(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["schedule"],{"34a7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"schedule-content"},[e.show?a("van-calendar",{style:{height:"370px"},attrs:{poppable:!1,"show-confirm":!1,"show-mark":!0,"min-date":e.minDate,"row-height":48,formatter:e.formatter},on:{select:e.selectDate}}):e._e(),e.detail.workDate?a("div",{staticClass:"common-card padding-0"},[a("div",{staticClass:"card-title style-title"},[a("div",[e._v(e._s(e.toDateFormat(e.detail.workDate,"MM月dd日"))+"排班")]),a("div",{staticClass:"status",class:1===e.detail.type?"":"un-normal"},[e._v(" "+e._s(e.statusFilter(e.detail.type))+" ")])]),e.showDetail?e._l(e.detail.workSchedule,(function(t,s){return a("div",{key:s,staticClass:"schedule-item"},[a("div",{staticClass:"schedule-time"},[a("div",{staticClass:"schedule-icon"}),e._v(" "+e._s(e.detail.workShiftName||"--")+" "+e._s(t.timeRange[0])+"-"+e._s(t.timeRange[1])+" ")]),a("div",{staticClass:"schedule-area"},[a("div",{staticClass:"area-icon"}),e._v(" "+e._s(e.detail.mapAreaNames||"--")+" ")])])})):e._e()],2):e._e()],1)},i=[],o=(a("4160"),a("d3b7"),a("159b"),a("afaa")),n=function(e){return Object(o["a"])({method:"GET",url:"/api-customer/sanitation-backend/work_schedule/v3/page",params:e})},r=function(e){return Object(o["a"])({method:"GET",url:"/api-customer/staff-care/integral/getWorkSchedule",params:e})},l=a("b99b"),c=[{id:1,name:"正常",shortName:"班"},{id:2,name:"休息",shortName:"休"},{id:3,name:"请假",shortName:"假"},{id:4,name:"调班",shortName:"调"},{id:5,name:"加班",shortName:"加"}],d={name:"Schedule",data:function(){return{toDateFormat:l["a"],show:!1,minDate:new Date(0),showDetail:!1,detail:{},scheduleType:{},scheduleData:[]}},created:function(){this.load()},methods:{load:function(){var e=this,t=this.$store.state.userInfo.employeeId;if(t){var a={employeeIds:t,pageSize:100,page:1};n(a).then((function(t){e.scheduleData=t.data||[],e.scheduleData.forEach((function(t){e.scheduleType[t.workDate]=t.type})),e.detail=e.scheduleData[0]||{},e.getWorkSchedule(e.detail)})).finally((function(){e.show=!0}))}else this.$toast("本账号未关联职员，没有排班信息！")},selectDate:function(e){var t=this;this.detail={};var a=new Date(new Date(e).toLocaleDateString()).getTime();this.scheduleData.forEach((function(e){e.workDate===a&&(t.detail=e,t.getWorkSchedule(e))}))},getWorkSchedule:function(e){var t=this;e.workDate&&(this.showDetail=!1,r({timestamp:e.workDate}).then((function(e){if(e.workScheduleDetailResponse&&e.workScheduleDetailResponse.workShiftDto&&e.workScheduleDetailResponse.workShiftDto.workShiftPeriods){var a=e.workScheduleDetailResponse.workShiftDto.workShiftPeriods;t.detail.workSchedule=[];var s=0;a.forEach((function(e){t.detail.workSchedule.push({timeRange:[Object(l["a"])(s+e.startTime,"HH:mm"),Object(l["a"])(s+e.endTime,"HH:mm")]})}))}})).finally((function(){t.showDetail=!0})))},formatter:function(e){if(!this.show)return e;var t=new Date(new Date(e.date).toLocaleDateString()).getTime();return this.scheduleType[t]?(e.bottomInfo=this.statusFilter(this.scheduleType[t],"shortName"),e.className=1===this.scheduleType[t]?"work":"rest",e):e},statusFilter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",a="--";return c.forEach((function(s){e===s.id&&(a=s[t])})),a}}},h=d,u=(a("42a8"),a("2877")),m=Object(u["a"])(h,s,i,!1,null,"35aaa792",null);t["default"]=m.exports},"42a8":function(e,t,a){"use strict";a("fb2c")},fb2c:function(e,t,a){}}]);
//# sourceMappingURL=schedule.91f9e215.js.map
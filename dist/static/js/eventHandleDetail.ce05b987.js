(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["eventHandleDetail"],{"445d":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event-handle-detail"},[n("div",{staticClass:"main"},[n("div",{staticClass:"content"},[n("div",{staticClass:"title"},[t._v(t._s(t.issue.description))]),n("div",{staticClass:"img"},t._l(t.issue.imageUrls,(function(e,s){return n("li",{key:s},[n("img",{attrs:{src:e},on:{click:function(n){return t.preview(e)}}})])})),0),n("div",{staticClass:"address"},[t._v(t._s(t.issue.address))])]),n("van-cell-group",[n("van-cell",{attrs:{title:"设施类型",value:t.issue.facilityTypeName}}),n("van-cell",{attrs:{title:"问题分类",value:t.issue.issueTypeName}}),n("van-cell",{attrs:{title:"上报人",value:t.issue.reporterName}}),n("van-cell",{attrs:{title:"上报时间",value:t._f("formatDateTime")(t.issue.createTime)}}),n("van-cell",{attrs:{title:"处理截止时间",value:t._f("formatDateTime")(t.issue.deadLine)}}),t.issue.historyHandlers?n("van-cell",{attrs:{title:"前处理人",value:t.issue.historyHandlers}}):t._e(),t.issue.historyAssingers?n("van-cell",{attrs:{title:"指派人",value:t.issue.historyAssingers}}):t._e()],1)],1),n("van-popup",{style:{height:"30%"},attrs:{position:"bottom"},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[n("van-form",{staticClass:"no-handle-form",on:{submit:t.comfirm}},[n("van-field",{attrs:{rows:"3",autosize:"",label:"原因",type:"textarea",placeholder:"不能处理原因",rules:[{required:!0,message:"请填不能处理原因"}]},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),n("div",{staticStyle:{margin:"16px"}},[n("van-button",{attrs:{round:"",block:"",type:"primary","native-type":"submit"}},[t._v(" 提交 ")])],1)],1)],1),t.employeeId==t.issue.ownerId||null==t.issue.ownerId&&t.issue.issueOrgId==t.orgId?n("div",{staticClass:"btn-bottom issue-footer"},[1===t.issue.status?[n("van-button",{staticClass:"report-btn unableHandle",attrs:{round:""},on:{click:t.showDialog}},[t._v("不能处理")]),t.distance>100?n("van-button",{staticClass:"report-btn",attrs:{disabled:"disabled",round:"",type:"primary"},on:{click:function(e){return t.goToHandle(t.issue.id)}}},[t._v("去处理")]):n("van-button",{staticClass:"report-btn",attrs:{round:"",type:"primary"},on:{click:function(e){return t.goToHandle(t.issue.id)}}},[t._v("去处理")])]:t._e()],2):t._e(),n("van-popup",{style:{width:"85%"},attrs:{"close-on-click-overlay":!1},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[n("van-form",{on:{submit:t.onSubmit}},[n("van-field",{attrs:{type:"number",min:0,rules:[{required:!0,message:"请填写时长"}],label:"延时时长"},scopedSlots:t._u([{key:"right-icon",fn:function(){return[t._v(" 分钟 ")]},proxy:!0}]),model:{value:t.form.applicantMinutes,callback:function(e){t.$set(t.form,"applicantMinutes",e)},expression:"form.applicantMinutes"}}),n("van-field",{attrs:{type:"textarea",label:"申请理由",rules:[{required:!0,message:"请填写申请理由"}]},model:{value:t.form.applicationReason,callback:function(e){t.$set(t.form,"applicationReason",e)},expression:"form.applicationReason"}}),n("div",{staticStyle:{margin:"16px","text-align":"center"}},[n("van-button",{attrs:{type:"primary","native-type":"submit",size:"small"}},[t._v(" 申请 ")]),n("van-button",{attrs:{plain:"",type:"primary",size:"small"},on:{click:function(e){t.showPopup=!1}}},[t._v(" 取消 ")])],1)],1)],1)],1)},i=[],a=(n("baa5"),n("d3b7"),n("cea6"),n("28a2")),o=n("87d4"),r={data:function(){return{dialogVisible:!1,content:"",issue:{description:null,facilityCode:null,facilityTypeName:null,issueTypeId:null,issueTypeName:null,reporterId:null,reporterName:null,createTime:null,historyHandlers:null,historyAssingers:null,imageUrls:[],handledImageUrls:[]},form:{applicantMinutes:"",applicationReason:"",issueId:null},employeeId:this.$store.state.userInfo.employeeId,orgId:this.$store.state.userInfo.orgId,showPopup:!1,issueId:null,distance:null}},created:function(){var t=window.location.href,e=t.lastIndexOf("/"),n=t.substring(e+1,t.length),s=t.substring(0,e),i=s.lastIndexOf("/"),a=s.substring(i+1,s.length);-1==n&&(n=null),this.distance=n,this.issueId=a,this.queryDetail(this.issueId)},methods:{applyDelay:function(t){console.log(t),this.form={},this.form.issueId=t.id,this.showPopup=!0},queryDetail:function(t){var e=this,n={id:t};Object(o["d"])(n).then((function(t){e.issue=t}))},goToHandle:function(t){this.$router.push({path:"/eventReport/eventHandle/".concat(t),params:{id:t}})},comfirm:function(){var t=this,e={description:this.content,issueId:this.issueId};""===this.content?this.$toast("请输入不能处理的理由"):Object(o["f"])({data:e}).then((function(){t.content="",t.$toast.success("提交成功！"),t.$router.back()})).catch((function(e){t.$toast.fail(e)})).finally((function(){t.dialogVisible=!1}))},onSubmit:function(){var t=this;Object(o["a"])(this.form).then((function(){t.$toast.success("申请成功，待审核中..."),t.$router.back()})).catch((function(t){console.log(t)})).finally((function(){t.showPopup=!1}))},showDialog:function(){this.dialogVisible=!0,this.content=""},preview:function(t){t&&Object(a["a"])([t])}}},l=r,u=(n("61b5"),n("2877")),c=Object(u["a"])(l,s,i,!1,null,"5e8b1644",null);e["default"]=c.exports},"4fef":function(t,e,n){},"61b5":function(t,e,n){"use strict";n("4fef")},"87d4":function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"a",(function(){return c}));var s=n("afaa"),i=function(t){return Object(s["a"])({url:"/api-customer/location/issue/report",method:"POST",data:t})},a=function(t){return Object(s["a"])({url:"/api-customer/location/issueClassifys",method:"GET",params:t})},o=function(t){return Object(s["a"])({url:"/api-customer/location/issues/among/".concat(t.id),method:"GET"})},r=function(t){return Object(s["a"])({url:"/api-customer/location/facility/types",method:"GET",params:t})},l=function(t){return Object(s["a"])({url:"api-customer/location/issue/handle",method:"POST",data:t})},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])({url:"/api-customer/location/issue/unableHandle",method:"POST",data:t.data})},c=function(t){return Object(s["a"])({url:"/api-customer/location/issuePostpone/create",method:"POST",data:t})}},baa5:function(t,e,n){var s=n("23e7"),i=n("e58c");s({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},e58c:function(t,e,n){"use strict";var s=n("fc6a"),i=n("a691"),a=n("50c4"),o=n("a640"),r=n("ae40"),l=Math.min,u=[].lastIndexOf,c=!!u&&1/[1].lastIndexOf(1,-0)<0,d=o("lastIndexOf"),p=r("indexOf",{ACCESSORS:!0,1:0}),f=c||!d||!p;t.exports=f?function(t){if(c)return u.apply(this,arguments)||0;var e=s(this),n=a(e.length),o=n-1;for(arguments.length>1&&(o=l(o,i(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in e&&e[o]===t)return o||0;return-1}:u}}]);
//# sourceMappingURL=eventHandleDetail.ce05b987.js.map